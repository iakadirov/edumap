# Настройка Vercel для EduMap.uz

## Шаг 1: Подключить репозиторий

1. Откройте https://vercel.com
2. Войдите через GitHub (если еще не залогинены)
3. Нажмите **Add New** → **Project**
4. Выберите репозиторий `iakadirov/edumap`
5. Нажмите **Import**

## Шаг 2: Настроить проект

### Framework Preset
- **Framework Preset**: Next.js (должно определиться автоматически)
- **Root Directory**: `./` (корень проекта)
- **Build Command**: `npm run build` (по умолчанию)
- **Output Directory**: `.next` (по умолчанию)
- **Install Command**: `npm install` (по умолчанию)

### Environment Variables
Нажмите **Environment Variables** и добавьте:

```
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
```

⚠️ **Важно:** Эти переменные должны быть теми же, что в `.env.local`

### Настройки деплоя
- **Node.js Version**: 20.x (или последняя LTS)
- Остальные настройки оставьте по умолчанию

## Шаг 3: Деплой

1. Нажмите **Deploy**
2. Дождитесь завершения деплоя (1-2 минуты)
3. Vercel автоматически создаст URL типа: `edumap-xxx.vercel.app`

## Шаг 4: Настроить кастомный домен ✅ БЕСПЛАТНО

**Важно:** Vercel Free план позволяет подключать кастомные домены без ограничений!

### 4.1 Добавить домен в Vercel

1. Перейдите в ваш проект на Vercel
2. Откройте **Settings** → **Domains**
3. Нажмите **Add Domain**
4. Введите ваш домен (например: `edumap.uz` или `www.edumap.uz`)
5. Нажмите **Add**

### 4.2 Настроить DNS записи

Vercel покажет вам, какие DNS записи нужно добавить. Есть два варианта:

#### Вариант A: Использовать Vercel DNS (рекомендуется)
Если ваш регистратор домена поддерживает:
- Добавьте NS записи, которые даст Vercel
- Vercel автоматически настроит все остальное

#### Вариант B: Настроить вручную (если NS записи недоступны)

Добавьте следующие записи в DNS вашего регистратора:

**Для корневого домена (edumap.uz):**
```
Type: A
Name: @
Value: 76.76.21.21
```

**Для поддомена www (www.edumap.uz):**
```
Type: CNAME
Name: www
Value: cname.vercel-dns.com
```

Или используйте ANAME/ALIAS записи (если поддерживается):
```
Type: ANAME (или ALIAS)
Name: @
Value: cname.vercel-dns.com
```

### 4.3 Проверка DNS

1. После добавления DNS записей, вернитесь в Vercel
2. Нажмите **Refresh** в разделе Domains
3. Vercel автоматически проверит DNS записи
4. **SSL сертификат будет выдан автоматически** (Let's Encrypt)
5. Обычно это занимает **5-30 минут**, но может быть до 24 часов

### 4.4 Ограничения Free плана

✅ **Что доступно бесплатно:**
- Неограниченное количество кастомных доменов
- Автоматический SSL (HTTPS)
- Автоматическое обновление сертификатов
- Поддержка www и корневого домена

⚠️ **Ограничения:**
- Нет возможности настроить redirects для доменов (только на Pro)
- Нет advanced DNS настроек (но базовые работают)

### 4.5 Проверка работы

После настройки DNS:
1. Подождите 5-30 минут
2. Проверьте статус в Vercel Dashboard (должен быть ✅ Valid)
3. Откройте ваш домен в браузере
4. Проверьте, что HTTPS работает (замочек в адресной строке)

### Troubleshooting DNS

**Проблема: "DNS not configured"**
- Убедитесь, что DNS записи добавлены правильно
- Проверьте, что прошло достаточно времени (до 24 часов)
- Используйте инструменты проверки DNS: https://dnschecker.org

**Проблема: "SSL certificate pending"**
- Обычно выдается автоматически через 5-30 минут
- Если не выдается через 24 часа, обратитесь в поддержку Vercel

**Проблема: Домен не открывается**
- Проверьте, что DNS записи правильные
- Убедитесь, что домен правильно добавлен в Vercel
- Проверьте кэш DNS: `nslookup edumap.uz`

## Шаг 5: Автодеплой (настроен автоматически)

После первого деплоя Vercel автоматически:
- ✅ Настроит автодеплой из GitHub
- ✅ Каждый push в `main` будет триггерить новый деплой
- ✅ Каждый PR получит preview URL

## Проверка

После деплоя:

1. Откройте URL проекта в Vercel
2. Проверьте, что главная страница загружается
3. Проверьте консоль браузера на ошибки
4. Проверьте, что нет ошибок подключения к Supabase

## Troubleshooting

### Ошибка: "Environment variable not found"

- Проверьте, что переменные добавлены в Vercel
- Убедитесь, что названия переменных совпадают с теми, что в коде

### Ошибка: "Build failed"

- Проверьте логи в Vercel Dashboard
- Убедитесь, что `npm run build` работает локально
- Проверьте версию Node.js

### Ошибка подключения к Supabase

- Проверьте переменные окружения в Vercel
- Убедитесь, что RLS политики настроены правильно
- Проверьте, что Supabase URL и ключ правильные

---

*После настройки Vercel проект будет автоматически деплоиться при каждом push в GitHub*

