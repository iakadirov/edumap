# 🎯 AI School Matcher — Система умного подбора школы

> **Модуль**: School Matcher
> **Страница**: `/schools/match`
> **Версия**: 1.0
> **Дата**: Декабрь 2024
> **Статус**: Ядро проекта

---

## 1. Философия модуля

### Почему это ядро проекта

```
ПРОБЛЕМА РОДИТЕЛЯ:
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  "Я вижу 100+ школ в каталоге. У меня нет времени изучать      │
│   каждую. Я не эксперт в образовании. Я просто хочу найти      │
│   ПРАВИЛЬНУЮ школу для МОЕГО ребёнка."                         │
│                                                                 │
│  → Паралич выбора                                               │
│  → Страх ошибиться                                              │
│  → Доверие "сарафанному радио" вместо объективных данных       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

НАШЕ РЕШЕНИЕ:
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  "Расскажите о вашем ребёнке и ваших приоритетах за 5 минут.   │
│   Мы подберём школы, которые подходят именно вам, и объясним   │
│   ПОЧЕМУ они подходят."                                         │
│                                                                 │
│  → Персонализация на основе данных                              │
│  → Прозрачная логика рекомендаций                               │
│  → Экономия времени родителя                                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Ключевые принципы

| Принцип | Описание |
|---------|----------|
| **Не продаём, а помогаем** | Рекомендации основаны на соответствии, а не на оплате школы |
| **Прозрачность** | Родитель видит, почему конкретная школа рекомендована |
| **Гибкость** | Можно изменить приоритеты и увидеть другие результаты |
| **Обучение** | Помогаем родителю понять, что важно при выборе |

---

## 2. Архитектура системы подбора

### Общая схема

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  РОДИТЕЛЬ                                                                   │
│      │                                                                      │
│      ▼                                                                      │
│  ┌────────────────────┐                                                     │
│  │   АНКЕТА (Quiz)    │  5-7 минут                                         │
│  │   8-12 вопросов    │                                                     │
│  └────────────────────┘                                                     │
│      │                                                                      │
│      ▼                                                                      │
│  ┌────────────────────┐     ┌────────────────────┐                         │
│  │   ПРОФИЛЬ СЕМЬИ    │────▶│   MATCHING ENGINE  │                         │
│  │   (Child + Parent  │     │   (AI + Rules)     │                         │
│  │    Preferences)    │     │                    │                         │
│  └────────────────────┘     └────────────────────┘                         │
│                                    │                                        │
│                                    ▼                                        │
│                           ┌────────────────────┐                           │
│                           │   БАЗА ШКОЛ        │                           │
│                           │   (Профили школ,   │                           │
│                           │    рейтинги,       │                           │
│                           │    характеристики) │                           │
│                           └────────────────────┘                           │
│                                    │                                        │
│                                    ▼                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        РЕЗУЛЬТАТЫ                                   │   │
│  │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐       │   │
│  │  │ TOP Match 95%   │ │ Match 87%       │ │ Match 82%       │       │   │
│  │  │ + объяснение    │ │ + объяснение    │ │ + объяснение    │       │   │
│  │  └─────────────────┘ └─────────────────┘ └─────────────────┘       │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. Параметры подбора — полная карта

### 3.1 Категории параметров

```
ПАРАМЕТРЫ ПОДБОРА ШКОЛЫ
│
├── 🧒 О РЕБЁНКЕ (Child Profile)
│   ├── Базовое
│   │   ├── Возраст / класс поступления
│   │   ├── Пол ребёнка
│   │   └── Текущая школа (если есть)
│   │
│   ├── Академический профиль
│   │   ├── Успеваемость (текущая)
│   │   ├── Сильные предметы
│   │   ├── Предметы, требующие внимания
│   │   └── Особенности обучения (дислексия, СДВГ и т.д.)
│   │
│   ├── Интересы и таланты
│   │   ├── Академические интересы
│   │   ├── Спортивные интересы
│   │   ├── Творческие интересы
│   │   └── Технические интересы
│   │
│   ├── Характер и социальные навыки
│   │   ├── Интроверт / экстраверт
│   │   ├── Самостоятельность
│   │   ├── Реакция на конкуренцию
│   │   └── Адаптивность к новому
│   │
│   └── Языковой профиль
│       ├── Родной язык
│       ├── Уровень русского
│       ├── Уровень узбекского
│       └── Уровень английского
│
├── 👨‍👩‍👧 ПРИОРИТЕТЫ СЕМЬИ (Family Priorities)
│   ├── Образовательные цели
│   │   ├── Подготовка к зарубежному ВУЗу
│   │   ├── Подготовка к местному ВУЗу
│   │   ├── Всестороннее развитие
│   │   ├── Углублённое изучение предметов
│   │   └── Профессиональная ориентация
│   │
│   ├── Ценности в образовании
│   │   ├── Академическая строгость vs комфорт
│   │   ├── Индивидуальный подход
│   │   ├── Дисциплина
│   │   ├── Творческая свобода
│   │   ├── Религиозные/культурные ценности
│   │   └── Инклюзивность
│   │
│   └── Программа обучения
│       ├── Международная (Cambridge, IB, American)
│       ├── Национальная усиленная
│       └── Смешанная
│
├── 💰 ПРАКТИЧЕСКИЕ ОГРАНИЧЕНИЯ (Practical Constraints)
│   ├── Бюджет
│   │   ├── Ежемесячная плата (диапазон)
│   │   ├── Готовность к доп. расходам
│   │   └── Интерес к скидкам/грантам
│   │
│   ├── Логистика
│   │   ├── Район проживания / работы
│   │   ├── Максимальное время в пути
│   │   ├── Наличие своего транспорта
│   │   └── Потребность в школьном транспорте
│   │
│   └── Расписание
│       ├── Нужна ли продлёнка
│       ├── Важность кружков в школе
│       └── Режим дня семьи
│
├── 🏫 ТРЕБОВАНИЯ К ШКОЛЕ (School Requirements)
│   ├── Инфраструктура
│   │   ├── Бассейн
│   │   ├── Спортивные объекты
│   │   ├── Научные лаборатории
│   │   ├── IT/STEM оснащение
│   │   └── Творческие студии
│   │
│   ├── Услуги
│   │   ├── Питание
│   │   ├── Медицинский кабинет
│   │   ├── Психолог/логопед
│   │   └── Охрана/безопасность
│   │
│   └── Дополнительно
│       ├── Размер классов
│       ├── Соотношение учитель/ученик
│       └── Возраст школы / опыт
│
└── 🎯 ПЛАНЫ НА БУДУЩЕЕ (Future Goals)
    ├── Страна для высшего образования
    ├── Сфера интересов для профессии
    ├── Экзамены (IELTS, SAT, DTM)
    └── Важность международных связей
```

### 3.2 Веса параметров по умолчанию

| Категория | Вес | Обоснование |
|-----------|-----|-------------|
| Практические ограничения | 35% | Если не подходит по бюджету/локации — всё остальное неважно |
| Образовательные цели | 25% | Определяет направление развития ребёнка |
| Профиль ребёнка | 20% | Школа должна соответствовать особенностям ребёнка |
| Ценности семьи | 15% | Философия школы должна совпадать |
| Инфраструктура/услуги | 5% | Nice to have, не критично |

**Важно**: Родитель может изменить приоритеты через интерфейс.

---

## 4. Дизайн анкеты (Quiz Flow)

### 4.1 Структура анкеты

```
ЭТАПЫ АНКЕТЫ
│
├── 0. ПРИВЕТСТВИЕ (Welcome)
│   └── Объяснение процесса, ~30 сек
│
├── 1. О РЕБЁНКЕ (3-4 вопроса, ~2 мин)
│   ├── Класс поступления
│   ├── Характер ребёнка
│   ├── Интересы и увлечения
│   └── Языки
│
├── 2. ВАШИ ПРИОРИТЕТЫ (3-4 вопроса, ~2 мин)
│   ├── Главная цель образования
│   ├── Что важнее: академичность или комфорт
│   ├── Тип программы
│   └── Ценности
│
├── 3. ПРАКТИЧЕСКИЕ ВОПРОСЫ (2-3 вопроса, ~1 мин)
│   ├── Бюджет
│   ├── Локация
│   └── Логистика
│
├── 4. ДОПОЛНИТЕЛЬНО (опционально, ~1 мин)
│   ├── Особые требования
│   ├── Что точно НЕ хотите
│   └── Важные детали
│
└── 5. РЕЗУЛЬТАТЫ
    └── Персональные рекомендации
```

### 4.2 Wireframe: Welcome Screen

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  🎓 EduMap                                              [RU] [UZ]  [Войти] │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                                                                             │
│                            🎯                                               │
│                                                                             │
│              Найдём идеальную школу для вашего ребёнка                     │
│                                                                             │
│     ─────────────────────────────────────────────────────────────          │
│                                                                             │
│              Ответьте на несколько вопросов, и мы подберём                 │
│              школы, которые подходят именно вам                            │
│                                                                             │
│                                                                             │
│              ┌─────────────────────────────────────────┐                   │
│              │                                         │                   │
│              │      ⏱️  5-7 минут на заполнение        │                   │
│              │      📋  10-12 простых вопросов         │                   │
│              │      🎯  Персональные рекомендации      │                   │
│              │      💡  Объяснение, почему подходит    │                   │
│              │                                         │                   │
│              └─────────────────────────────────────────┘                   │
│                                                                             │
│                                                                             │
│                    ┌───────────────────────────┐                           │
│                    │                           │                           │
│                    │   Начать подбор школы     │                           │
│                    │          →                │                           │
│                    └───────────────────────────┘                           │
│                                                                             │
│                                                                             │
│              Или  ─────────────────────────────────────                    │
│                                                                             │
│              [Перейти в каталог] — если знаете, что ищете                  │
│                                                                             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.3 Wireframe: Question Screen (Desktop)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  🎓 EduMap     Подбор школы                                        [×]     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │  ●───●───●───○───○───○───○───○───○───○                                │ │
│  │  Шаг 3 из 10                                          О РЕБЁНКЕ      │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                      │   │
│  │                                                                      │   │
│  │     Какой характер у вашего ребёнка?                                │   │
│  │                                                                      │   │
│  │     Это поможет подобрать школу с подходящей атмосферой             │   │
│  │                                                                      │   │
│  │                                                                      │   │
│  │     ┌─────────────────────────────────────────────────────────┐     │   │
│  │     │                                                         │     │   │
│  │     │  ┌─────────────────────────────────────────────────┐   │     │   │
│  │     │  │  🌟  Активный и общительный                     │   │     │   │
│  │     │  │      Легко заводит друзей, любит быть           │   │     │   │
│  │     │  │      в центре внимания                          │   │     │   │
│  │     │  └─────────────────────────────────────────────────┘   │     │   │
│  │     │                                                         │     │   │
│  │     │  ┌─────────────────────────────────────────────────┐   │     │   │
│  │     │  │  📚  Спокойный и вдумчивый                      │   │     │   │
│  │     │  │      Предпочитает небольшой круг друзей,        │   │     │   │
│  │     │  │      любит сосредоточенную работу               │   │     │   │
│  │     │  └─────────────────────────────────────────────────┘   │     │   │
│  │     │                                                         │     │   │
│  │     │  ┌─────────────────────────────────────────────────┐   │     │   │
│  │     │  │  ⚖️  Зависит от ситуации                        │   │     │   │
│  │     │  │      Может быть и активным, и спокойным         │   │     │   │
│  │     │  │      в зависимости от обстоятельств             │   │     │   │
│  │     │  └─────────────────────────────────────────────────┘   │     │   │
│  │     │                                                         │     │   │
│  │     │  ┌─────────────────────────────────────────────────┐   │     │   │
│  │     │  │  🤔  Затрудняюсь ответить                       │   │     │   │
│  │     │  └─────────────────────────────────────────────────┘   │     │   │
│  │     │                                                         │     │   │
│  │     └─────────────────────────────────────────────────────────┘     │   │
│  │                                                                      │   │
│  │                                                                      │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │                                                                       │ │
│  │     [← Назад]                                      [Далее →]         │ │
│  │                                                                       │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.4 Wireframe: Multiple Choice Question

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│     Чем увлекается ваш ребёнок?                                            │
│                                                                             │
│     Выберите все подходящие варианты                                       │
│                                                                             │
│                                                                             │
│     ┌─────────────────────────────────────────────────────────────────┐   │
│     │                                                                  │   │
│     │   АКАДЕМИЧЕСКОЕ                                                  │   │
│     │   ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐            │   │
│     │   │🔬     │ │📐     │ │💻     │ │🌍     │ │📖     │            │   │
│     │   │Науки  │ │Матем. │ │ IT    │ │Языки  │ │Чтение │            │   │
│     │   │  ✓    │ │       │ │  ✓    │ │       │ │       │            │   │
│     │   └───────┘ └───────┘ └───────┘ └───────┘ └───────┘            │   │
│     │                                                                  │   │
│     │   СПОРТ                                                          │   │
│     │   ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐            │   │
│     │   │⚽     │ │🏊     │ │🥋     │ │🎾     │ │♟️     │            │   │
│     │   │Футбол │ │Плаван.│ │ Борьба│ │Теннис │ │Шахматы│            │   │
│     │   │       │ │  ✓    │ │       │ │       │ │  ✓    │            │   │
│     │   └───────┘ └───────┘ └───────┘ └───────┘ └───────┘            │   │
│     │                                                                  │   │
│     │   ТВОРЧЕСТВО                                                     │   │
│     │   ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐            │   │
│     │   │🎨     │ │🎵     │ │🎭     │ │📷     │ │✍️     │            │   │
│     │   │Рисов. │ │Музыка │ │Театр  │ │Фото   │ │Письмо │            │   │
│     │   │       │ │       │ │       │ │       │ │       │            │   │
│     │   └───────┘ └───────┘ └───────┘ └───────┘ └───────┘            │   │
│     │                                                                  │   │
│     │   ┌──────────────────────────────────────────────────────┐      │   │
│     │   │ + Другое: ______________________________________     │      │   │
│     │   └──────────────────────────────────────────────────────┘      │   │
│     │                                                                  │   │
│     └─────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.5 Wireframe: Slider Question (Budget)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│     💰 Какой бюджет вы рассматриваете на обучение?                         │
│                                                                             │
│     Укажите комфортный диапазон ежемесячной оплаты                         │
│                                                                             │
│                                                                             │
│     ┌─────────────────────────────────────────────────────────────────┐   │
│     │                                                                  │   │
│     │                                                                  │   │
│     │      1 млн                                           15+ млн    │   │
│     │        │                                                 │      │   │
│     │        ●━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━●      │   │
│     │                ├───────────────────┤                            │   │
│     │               мин                 макс                          │   │
│     │                                                                  │   │
│     │              от 2.5 млн    до    6 млн сум                      │   │
│     │                                                                  │   │
│     │                                                                  │   │
│     │     ┌────────────────────────────────────────────────────┐      │   │
│     │     │  💡 В этом диапазоне 34 школы                      │      │   │
│     │     │     Средний рейтинг: 4.3 ⭐                         │      │   │
│     │     └────────────────────────────────────────────────────┘      │   │
│     │                                                                  │   │
│     │                                                                  │   │
│     │     ☐ Мне важно узнать о скидках и грантах                      │   │
│     │                                                                  │   │
│     │     ☐ Готов(а) рассмотреть варианты дороже,                     │   │
│     │       если школа идеально подходит                              │   │
│     │                                                                  │   │
│     └─────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.6 Wireframe: Location Question

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│     📍 Где вам удобно, чтобы находилась школа?                             │
│                                                                             │
│                                                                             │
│     ┌─────────────────────────────────────────────────────────────────┐   │
│     │                                                                  │   │
│     │  Район проживания / работы:                                      │   │
│     │  ┌─────────────────────────────────────────────────────────┐    │   │
│     │  │ Выберите район...                                  ▼   │    │   │
│     │  └─────────────────────────────────────────────────────────┘    │   │
│     │                                                                  │   │
│     │  Выбрано: [Юнусабадский ×] [Мирзо-Улугбекский ×]                │   │
│     │                                                                  │   │
│     │  ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─          │   │
│     │                                                                  │   │
│     │  Максимальное время в пути до школы:                            │   │
│     │                                                                  │   │
│     │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐            │   │
│     │  │ 15 мин  │  │ 30 мин  │  │ 45 мин  │  │ 60 мин  │            │   │
│     │  │         │  │    ✓    │  │         │  │         │            │   │
│     │  └─────────┘  └─────────┘  └─────────┘  └─────────┘            │   │
│     │                                                                  │   │
│     │  ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─          │   │
│     │                                                                  │   │
│     │  Транспорт:                                                      │   │
│     │                                                                  │   │
│     │  ○ Будем возить сами                                             │   │
│     │  ● Нужен школьный транспорт                                      │   │
│     │  ○ Ребёнок будет добираться сам                                  │   │
│     │                                                                  │   │
│     └─────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.7 Wireframe: Priority Ranking Question

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│     ⚖️ Расставьте приоритеты                                               │
│                                                                             │
│     Перетащите в порядке важности (сверху — самое важное)                  │
│                                                                             │
│                                                                             │
│     ┌─────────────────────────────────────────────────────────────────┐   │
│     │                                                                  │   │
│     │   1  ┌──────────────────────────────────────────────────┐       │   │
│     │      │  ☰  📚 Качество образования                      │       │   │
│     │      │      Сильные учителя, результаты выпускников     │       │   │
│     │      └──────────────────────────────────────────────────┘       │   │
│     │                                                                  │   │
│     │   2  ┌──────────────────────────────────────────────────┐       │   │
│     │      │  ☰  📍 Удобное расположение                      │       │   │
│     │      │      Близко к дому или работе                    │       │   │
│     │      └──────────────────────────────────────────────────┘       │   │
│     │                                                                  │   │
│     │   3  ┌──────────────────────────────────────────────────┐       │   │
│     │      │  ☰  💰 Доступная цена                            │       │   │
│     │      │      Соответствует бюджету семьи                 │       │   │
│     │      └──────────────────────────────────────────────────┘       │   │
│     │                                                                  │   │
│     │   4  ┌──────────────────────────────────────────────────┐       │   │
│     │      │  ☰  🌍 Международная программа                   │       │   │
│     │      │      Cambridge, IB или American curriculum       │       │   │
│     │      └──────────────────────────────────────────────────┘       │   │
│     │                                                                  │   │
│     │   5  ┌──────────────────────────────────────────────────┐       │   │
│     │      │  ☰  🏊 Инфраструктура                            │       │   │
│     │      │      Бассейн, спортзал, лаборатории              │       │   │
│     │      └──────────────────────────────────────────────────┘       │   │
│     │                                                                  │   │
│     └─────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. Полный список вопросов анкеты

### Секция 1: О ребёнке

| # | Вопрос | Тип | Варианты ответа | Влияет на |
|---|--------|-----|-----------------|-----------|
| 1 | В какой класс поступает ребёнок? | Dropdown | 1-11 класс, подготовка | Фильтр школ |
| 2 | Какой характер у ребёнка? | Single choice | Активный / Спокойный / Зависит | Размер класса, атмосфера |
| 3 | Чем увлекается ребёнок? | Multi choice | Науки, спорт, творчество, IT | Кружки, программы |
| 4 | Какие языки знает ребёнок? | Multi slider | Русский/Узбекский/English + уровень | Язык обучения |
| 5 | Есть ли особенности в обучении? | Optional multi | СДВГ, дислексия, одарённость | Спец. программы |

### Секция 2: Образовательные цели

| # | Вопрос | Тип | Варианты ответа | Влияет на |
|---|--------|-----|-----------------|-----------|
| 6 | Какая главная цель образования? | Single choice | Зарубежный ВУЗ / Местный ВУЗ / Развитие / Ещё не решили | Программа |
| 7 | Что важнее? | Slider | Академическая строгость ←→ Комфортная атмосфера | Тип школы |
| 8 | Какая программа предпочтительна? | Single choice | Cambridge / IB / Национальная+ / Неважно | Программа |
| 9 | Расставьте приоритеты | Ranking | 5 факторов | Веса алгоритма |

### Секция 3: Практические вопросы

| # | Вопрос | Тип | Варианты ответа | Влияет на |
|---|--------|-----|-----------------|-----------|
| 10 | Бюджет на обучение | Range slider | 1-15+ млн сум | Фильтр школ |
| 11 | Удобное расположение | Multi select + map | Районы + время в пути | Фильтр школ |
| 12 | Нужны ли доп. услуги? | Multi toggle | Транспорт / Питание / Продлёнка | Фильтр услуг |

### Секция 4: Дополнительно (опционально)

| # | Вопрос | Тип | Варианты ответа | Влияет на |
|---|--------|-----|-----------------|-----------|
| 13 | Что точно НЕ подходит? | Multi choice | Большие классы / Только девочки / Религиозные | Исключения |
| 14 | Есть ли особые требования? | Text input | Свободный текст | AI анализ |

---

## 6. Алгоритм матчинга (Matching Algorithm)

### 6.1 Формула расчёта Match Score

```
MATCH SCORE = Σ (Критерий_i × Вес_i × Соответствие_i)

где:
- Критерий_i — один из параметров подбора
- Вес_i — важность критерия (определяется пользователем через ranking)
- Соответствие_i — степень соответствия школы критерию (0.0 — 1.0)
```

### 6.2 Таблица критериев и расчёта соответствия

| Критерий | Как рассчитывается соответствие | Пример |
|----------|--------------------------------|--------|
| **Бюджет** | 1.0 если в диапазоне, 0.7 если до +20%, 0.3 если до +50%, 0 если выше | Бюджет 5 млн, школа 6 млн → 0.7 |
| **Локация** | 1.0 если в выбранном районе, убывает с расстоянием | Выбран Юнусабад, школа там → 1.0 |
| **Программа** | 1.0 если точное совпадение, 0.5 если частичное | Хочет Cambridge, есть Cambridge → 1.0 |
| **Язык** | 1.0 если основной язык, 0.8 если билингв | Хочет English, школа билингв → 0.8 |
| **Размер класса** | 1.0 если ≤ желаемого, убывает | Хочет до 15, в школе 12 → 1.0 |
| **Интересы ребёнка** | % совпадения кружков и программ | 3 из 4 интересов есть → 0.75 |
| **Транспорт** | 1.0 если есть когда нужен, 0 если нет | Нужен и есть → 1.0 |
| **Рейтинг школы** | Нормализованный от 0 до 1 | Рейтинг 4.5 из 5 → 0.9 |
| **Цель образования** | Совпадение с профилем выпускников | Цель зарубежный ВУЗ, 80% поступают → 0.8 |

### 6.3 Дополнительные бонусы/штрафы

```typescript
// Бонусы (добавляются к итоговому score)
const bonuses = {
  verified: 0.05,        // Верифицированная школа
  topRated: 0.03,        // TOP-10 в рейтинге
  awards: 0.02,          // Международные награды
  exactMatch: 0.05,      // Идеальное совпадение по главному критерию
};

// Штрафы (вычитаются)
const penalties = {
  noReviews: -0.1,       // Нет отзывов
  lowRating: -0.05,      // Рейтинг < 3.5
  notVerified: -0.03,    // Не верифицирована
  userExcluded: -1.0,    // Пользователь указал в "не хочу"
};
```

### 6.4 Пример расчёта

```
ПРОФИЛЬ ПОЛЬЗОВАТЕЛЯ:
- Бюджет: 3-5 млн
- Район: Юнусабад
- Программа: Cambridge
- Приоритеты: 1) Качество, 2) Локация, 3) Цена

ШКОЛА: Cambridge School Tashkent
- Цена: 4.5 млн ✓
- Район: Юнусабад ✓
- Программа: Cambridge ✓
- Рейтинг: 4.8

РАСЧЁТ:
┌─────────────────────────────────────────────────────────────────┐
│ Критерий         │ Вес   │ Соответствие │ Вклад               │
├──────────────────┼───────┼──────────────┼─────────────────────┤
│ Бюджет           │ 0.20  │ 1.0          │ 0.20                │
│ Локация          │ 0.25  │ 1.0          │ 0.25                │
│ Программа        │ 0.25  │ 1.0          │ 0.25                │
│ Качество/Рейтинг │ 0.30  │ 0.96         │ 0.288               │
├──────────────────┼───────┼──────────────┼─────────────────────┤
│ ИТОГО            │ 1.00  │              │ 0.988               │
│ + Бонус verified │       │              │ +0.05               │
│ + Бонус exactMatch│      │              │ +0.05               │
├──────────────────┼───────┼──────────────┼─────────────────────┤
│ FINAL SCORE      │       │              │ 98.8% → ≈99%        │
└─────────────────────────────────────────────────────────────────┘
```

---

## 7. Страница результатов

### 7.1 Wireframe: Results Page

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  🎓 EduMap     Результаты подбора                              [Сохранить] │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │                                                                       │ │
│  │   🎯 Мы подобрали 12 школ, которые подходят вам лучше всего          │ │
│  │                                                                       │ │
│  │   Ваш профиль: Cambridge → Юнусабад → до 5 млн сум   [Изменить]      │ │
│  │                                                                       │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │  🏆 ТОП-3 ИДЕАЛЬНЫЕ СОВПАДЕНИЯ                                        │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │ █████████████████████████████████████████████████████████████  99%   │ │
│  │                                                                       │ │
│  │  ┌─────────┐   Cambridge School Tashkent                             │ │
│  │  │         │                                                          │ │
│  │  │ [ФОТО]  │   ⭐ 4.8  │  Юнусабад  │  4.5 млн/мес                   │ │
│  │  │         │                                                          │ │
│  │  │  99%    │   ✓ Идеально по всем вашим критериям                    │ │
│  │  │  MATCH  │                                                          │ │
│  │  └─────────┘   Почему подходит:                                       │ │
│  │                • Cambridge программа — то, что вы искали              │ │
│  │                • В Юнусабаде — удобное расположение                   │ │
│  │                • 4.5 млн — в вашем бюджете                            │ │
│  │                • Есть плавание, IT — интересы вашего ребёнка          │ │
│  │                                                                       │ │
│  │                [Подробнее о школе]        [♡ Сохранить]               │ │
│  │                                                                       │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ┌─────────────────────────────────────┐ ┌─────────────────────────────────┐
│  │ █████████████████████████████  92%  │ │ █████████████████████████  87% │ │
│  │                                      │ │                                 │ │
│  │  [ФОТО]  Westminster School          │ │  [ФОТО]  Tashkent Int'l School │ │
│  │          ⭐ 4.6  │  Юнусабад          │ │          ⭐ 4.9  │  Яккасарай   │ │
│  │                                      │ │                                 │ │
│  │  Почему подходит:                    │ │  Почему подходит:               │ │
│  │  ✓ Cambridge программа               │ │  ✓ IB + Cambridge               │ │
│  │  ✓ В нужном районе                   │ │  ⚡ Не в вашем районе, но       │ │
│  │  ⚡ 5.5 млн — чуть выше бюджета      │ │     есть школьный транспорт     │ │
│  │                                      │ │  ⚡ 6 млн — выше бюджета        │ │
│  │  [Подробнее]      [♡]                │ │  [Подробнее]      [♡]           │ │
│  │                                      │ │                                 │ │
│  └─────────────────────────────────────┘ └─────────────────────────────────┘ │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │  📋 ЕЩЁ 9 ПОДХОДЯЩИХ ШКОЛ                                [Показать] │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │  💡 Что дальше?                                                       │ │
│  │                                                                       │ │
│  │  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐    │ │
│  │  │ 📊 Сравнить      │  │ 📅 Записаться    │  │ 💬 Задать вопрос │    │ │
│  │  │    ТОП-3 школы   │  │    на экскурсию  │  │    консультанту  │    │ │
│  │  └──────────────────┘  └──────────────────┘  └──────────────────┘    │ │
│  │                                                                       │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 7.2 Match Card Component

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ████████████████████████████████████████████████████████████████  99%     │
│  ─────────────────────────────────────────────────────────────────          │
│                                                                             │
│  ┌─────────────────┐    Cambridge School Tashkent                           │
│  │                 │                                                        │
│  │                 │    ✓ Верифицирована   🏆 #3 в рейтинге                │
│  │     [ФОТО]      │                                                        │
│  │                 │    ⭐ 4.8 (127 отзывов)  │  📍 Юнусабад               │
│  │                 │                                                        │
│  │   ┌─────────┐   │    [Cambridge] [Билингв] [1-11 класс]                 │
│  │   │  99%    │   │                                                        │
│  │   │ MATCH   │   │    от 4.5 млн сум / месяц                             │
│  │   └─────────┘   │                                                        │
│  │                 │    ─────────────────────────────────────              │
│  │   [♡]           │                                                        │
│  └─────────────────┘    Почему эта школа вам подходит:                      │
│                                                                             │
│                         ✓ Cambridge программа — именно то, что вы          │
│                           указали как приоритет                             │
│                                                                             │
│                         ✓ Юнусабадский район — удобно для вас              │
│                                                                             │
│                         ✓ 4.5 млн сум — в пределах вашего бюджета          │
│                                                                             │
│                         ✓ Есть плавание и IT-кружок — интересы             │
│                           вашего ребёнка                                    │
│                                                                             │
│                         ✓ Рейтинг 4.8 — одна из лучших школ                │
│                                                                             │
│                                                                             │
│                         ┌────────────────────────────────────────────┐     │
│                         │  [Подробнее о школе]    [♡ В избранное]   │     │
│                         └────────────────────────────────────────────┘     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 7.3 Match Indicator Design

```
MATCH SCORE ВИЗУАЛИЗАЦИЯ:

95-100%  🟢 Идеальное совпадение
─────────────────────────────────
Progress bar: green-500 (#22C55E)
Badge: "Идеально подходит"
Border: green-200

85-94%   🔵 Отличное совпадение
─────────────────────────────────
Progress bar: blue-500 (#3B82F6)
Badge: "Отлично подходит"

70-84%   🟡 Хорошее совпадение
─────────────────────────────────
Progress bar: amber-500 (#F59E0B)
Badge: "Хорошо подходит"

50-69%   🟠 Частичное совпадение
─────────────────────────────────
Progress bar: orange-500 (#F97316)
Badge: "Частично подходит"

<50%     🔴 Слабое совпадение
─────────────────────────────────
Не показываем в результатах
```

---

## 8. Объяснение рекомендаций (Explainability)

### 8.1 Структура объяснения

```typescript
interface MatchExplanation {
  school: School;
  matchScore: number;
  
  // Почему подходит (позитивные факторы)
  positiveFactors: {
    criterion: string;
    explanation: string;
    impact: 'high' | 'medium' | 'low';
  }[];
  
  // На что обратить внимание (негативные/нейтральные)
  considerations: {
    criterion: string;
    explanation: string;
    severity: 'minor' | 'notable';
  }[];
  
  // Для какого типа семей особенно подходит
  idealFor: string[];
}
```

### 8.2 Примеры объяснений

```
ПОЗИТИВНЫЕ ФАКТОРЫ:
───────────────────────────────────────────────────────────────
✓ Cambridge программа
  "Именно то, что вы указали как приоритет. В школе полный
   цикл Cambridge: Primary, Secondary, IGCSE и A-Level."

✓ Удобное расположение
  "Школа находится в Юнусабадском районе, который вы выбрали.
   15 минут от метро Минор."

✓ В пределах бюджета
  "4.5 млн сум/месяц — попадает в ваш диапазон 3-5 млн."

✓ Совпадение интересов
  "Есть секции плавания и робототехники, которыми интересуется
   ваш ребёнок."


ОБРАТИТЕ ВНИМАНИЕ:
───────────────────────────────────────────────────────────────
⚡ Размер классов
  "В среднем 18 учеников в классе. Вы указали предпочтение
   до 15 человек, но школа компенсирует это индивидуальным
   подходом."

⚡ Нет продлёнки после 17:00
  "Группа продлённого дня работает до 17:00. Вы указали
   потребность до 18:00."
```

### 8.3 Wireframe: Detailed Match Breakdown

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  📊 Подробный анализ соответствия                                          │
│                                                                             │
│  Cambridge School Tashkent                              Общий балл: 99%    │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  Программа обучения                                                        │
│  ███████████████████████████████████████████████████████████████  100%    │
│  ✓ Cambridge — полное совпадение с вашим выбором                          │
│                                                                             │
│  Расположение                                                               │
│  ███████████████████████████████████████████████████████████████  100%    │
│  ✓ Юнусабадский район — именно то, что вы искали                          │
│                                                                             │
│  Бюджет                                                                     │
│  ███████████████████████████████████████████████████████████████  100%    │
│  ✓ 4.5 млн — в пределах вашего бюджета 3-5 млн                            │
│                                                                             │
│  Качество образования                                                       │
│  ██████████████████████████████████████████████████████████████   96%     │
│  ✓ Рейтинг 4.8 — одна из лучших школ в Ташкенте                           │
│                                                                             │
│  Интересы ребёнка                                                          │
│  █████████████████████████████████████████████████████████        85%     │
│  ✓ Плавание, Робототехника                                                 │
│  ○ Нет секции тенниса                                                      │
│                                                                             │
│  Размер классов                                                             │
│  ████████████████████████████████████████████                     70%     │
│  ⚡ 18 учеников (вы хотели до 15)                                          │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  💡 Эта школа особенно подходит для:                                       │
│     • Семей, планирующих обучение за рубежом                               │
│     • Детей с высокой мотивацией к учёбе                                   │
│     • Родителей, ценящих британскую образовательную систему                │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 9. Сценарии использования

### 9.1 User Journey

```
СЦЕНАРИЙ: Родитель ищет школу с Cambridge для 5-классника

1. ВХОД
   Пользователь: Кликает "Подобрать школу" на главной
   Система: Показывает welcome screen

2. АНКЕТА
   Пользователь: Проходит 10 вопросов за 5 минут
   Система: Собирает профиль, показывает прогресс

3. ОБРАБОТКА
   Пользователь: Видит анимацию "Анализируем 95 школ..."
   Система: Рассчитывает match scores для всех школ

4. РЕЗУЛЬТАТЫ
   Пользователь: Видит ТОП-3 с объяснениями
   Система: Показывает почему каждая школа подходит

5. ИССЛЕДОВАНИЕ
   Пользователь: Открывает детальную страницу школы
   Система: Показывает профиль школы + персональные заметки

6. ДЕЙСТВИЕ
   Пользователь: Сохраняет в избранное, записывается на экскурсию
   Система: Отправляет заявку в школу

7. ПОВТОРНЫЙ ВИЗИТ
   Пользователь: Возвращается через неделю
   Система: Показывает сохранённые результаты + обновления
```

### 9.2 Edge Cases

| Ситуация | Решение |
|----------|---------|
| Нет школ по бюджету | Показать ближайшие варианты + предложить расширить бюджет |
| Нет школ в районе | Показать школы в соседних районах с транспортом |
| Противоречивые требования | Показать trade-offs, объяснить компромиссы |
| Слишком мало данных | Попросить ответить на доп. вопросы |
| Пользователь бросил анкету | Сохранить прогресс, напомнить по email |

---

## 10. Сохранение и повторное использование

### 10.1 Сохранение профиля

```typescript
interface SavedMatchProfile {
  id: string;
  userId?: string;          // если зарегистрирован
  sessionId: string;        // если гость
  
  childProfile: {
    grade: number;
    character: string;
    interests: string[];
    languages: Record<string, number>;
    specialNeeds?: string[];
  };
  
  familyPriorities: {
    mainGoal: string;
    academicVsComfort: number;  // 0-100 scale
    preferredCurriculum: string[];
    priorityRanking: string[];
    values: string[];
  };
  
  practicalConstraints: {
    budgetMin: number;
    budgetMax: number;
    budgetFlexible: boolean;
    districts: string[];
    maxTravelTime: number;
    needsTransport: boolean;
    needsExtendedDay: boolean;
    needsMeals: boolean;
  };
  
  exclusions: string[];     // что точно не хочет
  
  createdAt: Date;
  updatedAt: Date;
  
  // Результаты
  results: {
    schoolId: string;
    matchScore: number;
    savedAt?: Date;
    notes?: string;
  }[];
}
```

### 10.2 "Изменить параметры" функционал

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ⚙️ Ваши параметры подбора                                    [Сохранить] │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  О РЕБЁНКЕ                                                    [Изменить]   │
│  5 класс • Активный характер • Плавание, IT, шахматы                       │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  ЦЕЛИ                                                         [Изменить]   │
│  Зарубежный ВУЗ • Cambridge программа • Баланс строгости и комфорта       │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  ПРАКТИЧЕСКОЕ                                                 [Изменить]   │
│  3-5 млн сум • Юнусабад, Мирзо-Улугбек • до 30 мин • Нужен транспорт      │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  ПРИОРИТЕТЫ                                                   [Изменить]   │
│  1. Качество → 2. Локация → 3. Программа → 4. Цена → 5. Инфраструктура    │
│                                                                             │
│                    ┌─────────────────────────────────┐                     │
│                    │   Обновить рекомендации   →     │                     │
│                    └─────────────────────────────────┘                     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 11. Mobile Experience

### 11.1 Mobile Quiz Flow

```
┌─────────────────────────────┐
│  ← Подбор школы       ✕    │
├─────────────────────────────┤
│                             │
│  ●●●○○○○○○○  3/10          │
│                             │
├─────────────────────────────┤
│                             │
│  О РЕБЁНКЕ                  │
│                             │
│  Какой характер             │
│  у вашего ребёнка?          │
│                             │
│  ┌───────────────────────┐  │
│  │                       │  │
│  │  🌟 Активный и        │  │
│  │     общительный       │  │
│  │                       │  │
│  └───────────────────────┘  │
│                             │
│  ┌───────────────────────┐  │
│  │                       │  │
│  │  📚 Спокойный и       │  │
│  │     вдумчивый         │  │
│  │                       │  │
│  └───────────────────────┘  │
│                             │
│  ┌───────────────────────┐  │
│  │                       │  │
│  │  ⚖️ Зависит от        │  │
│  │     ситуации          │  │
│  │                       │  │
│  └───────────────────────┘  │
│                             │
├─────────────────────────────┤
│                             │
│  [← Назад]      [Далее →]  │
│                             │
└─────────────────────────────┘
```

### 11.2 Mobile Results

```
┌─────────────────────────────┐
│  🎯 Результаты      [✕]    │
├─────────────────────────────┤
│                             │
│  Найдено 12 школ для вас    │
│  [Ваш профиль ▼]           │
│                             │
├─────────────────────────────┤
│                             │
│  🏆 ЛУЧШЕЕ СОВПАДЕНИЕ       │
│                             │
│  ┌───────────────────────┐  │
│  │ ████████████████ 99%  │  │
│  ├───────────────────────┤  │
│  │                       │  │
│  │  [ФОТО]               │  │
│  │                       │  │
│  │  Cambridge School     │  │
│  │  Tashkent             │  │
│  │                       │  │
│  │  ⭐ 4.8 │ Юнусабад    │  │
│  │  4.5 млн/мес          │  │
│  │                       │  │
│  │  ✓ Cambridge          │  │
│  │  ✓ В нужном районе    │  │
│  │  ✓ В бюджете          │  │
│  │                       │  │
│  │  [Подробнее]    [♡]  │  │
│  │                       │  │
│  └───────────────────────┘  │
│                             │
│  ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│                             │
│  [Ещё 11 школ ▼]           │
│                             │
└─────────────────────────────┘
```

---

## 12. Технические требования

### 12.1 API Endpoints

```typescript
// Создание/обновление профиля подбора
POST /api/match/profile
Body: SavedMatchProfile
Response: { profileId: string, results: MatchResult[] }

// Получение результатов
GET /api/match/results/:profileId
Response: { profile: SavedMatchProfile, results: MatchResult[] }

// Пересчёт с новыми параметрами
PUT /api/match/profile/:profileId
Body: Partial<SavedMatchProfile>
Response: { results: MatchResult[] }

// Получение объяснения для школы
GET /api/match/explain/:profileId/:schoolId
Response: MatchExplanation
```

### 12.2 Структура ответа матчинга

```typescript
interface MatchResult {
  school: SchoolSummary;
  matchScore: number;
  matchTier: 'perfect' | 'excellent' | 'good' | 'partial';
  
  positiveFactors: {
    criterion: string;
    score: number;
    explanation: string;
  }[];
  
  considerations: {
    criterion: string;
    explanation: string;
  }[];
  
  comparisonToOthers: {
    betterThan: number;      // "лучше чем 95% школ"
    uniqueAdvantages: string[];
  };
}
```

### 12.3 Performance Requirements

| Метрика | Требование |
|---------|------------|
| Время расчёта | < 2 секунды для 100 школ |
| Размер payload | < 50KB на результат |
| Кэширование | Результаты кэшируются на 1 час |
| Анимация | 60fps на всех устройствах |

---

## 13. A/B тестирование и улучшения

### 13.1 Метрики успеха

| Метрика | Цель | Как измерять |
|---------|------|--------------|
| Completion Rate | >70% | % прошедших анкету до конца |
| Time to Complete | <6 мин | Среднее время прохождения |
| Result Satisfaction | >4.5/5 | Опрос после просмотра результатов |
| Click-through | >50% | % открывших хотя бы 1 школу |
| Conversion | >10% | % записавшихся на экскурсию |
| Return Rate | >30% | % вернувшихся в течение недели |

### 13.2 Варианты для тестирования

```
A/B ТЕСТЫ:
─────────────────────────────────────────────────────────────
1. Количество вопросов: 8 vs 10 vs 12
2. Порядок секций: Ребёнок→Цели→Бюджет vs Бюджет→Ребёнок→Цели
3. Визуализация match: Процент vs Звёзды vs Категории
4. Объяснения: Краткие vs Детальные
5. CTA: "Подробнее" vs "Записаться" vs "Сравнить"
```

---

## 14. Интеграция с другими модулями

### 14.1 Связь с каталогом

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│  [Каталог школ]                                                            │
│                                                                            │
│  У вас есть сохранённый профиль подбора                                    │
│  ┌────────────────────────────────────────────────────────────────────┐   │
│  │  Cambridge • Юнусабад • 3-5 млн             [Показать совпадения] │   │
│  └────────────────────────────────────────────────────────────────────┘   │
│                                                                            │
│  Или примените свои фильтры вручную                                        │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

### 14.2 Badges в каталоге

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                                                                              │
│  ┌────────────────┐  ┌────────────────────────────────────┐  ┌────────────┐ │
│  │                │  │                                     │  │            │ │
│  │                │  │  ✓ Верифицирована                   │  │  от 3.5    │ │
│  │                │  │                                     │  │  млн сум   │ │
│  │   [ФОТО]       │  │  Cambridge School Tashkent          │  │            │ │
│  │                │  │                                     │  │            │ │
│  │                │  │  ⭐ 4.8  │  Юнусабад                │  │            │ │
│  │  ┌──────────┐  │  │                                     │  │ ─────────  │ │
│  │  │  99%     │  │  │  [Cambridge] [Билингв] [1-11]      │  │            │ │
│  │  │ MATCH    │  │  │                                     │  │  [Подроб-] │ │
│  │  │ для вас  │  │  │  🏊 🚌 🍽 🔬                        │  │  [  нее  ] │ │
│  │  └──────────┘  │  │                                     │  │            │ │
│  │                │  │                                     │  │            │ │
│  └────────────────┘  └────────────────────────────────────┘  └────────────┘ │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

Badge "99% MATCH для вас" появляется только если:
- У пользователя есть сохранённый профиль подбора
- Школа входит в TOP-20 рекомендаций
```

---

*Версия 1.0 — Декабрь 2024*
*Это ядро проекта EduMap — умный помощник в выборе школы*
