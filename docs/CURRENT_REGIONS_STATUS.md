# –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±–ª–∞—Å—Ç–µ–π –∏ —Ä–µ–≥–∏–æ–Ω–æ–≤ –≤ –ë–î

## ‚úÖ –ß—Ç–æ –ï–°–¢–¨ –≤ –ë–î

### –ü–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `organizations`:

1. **`region`** (TEXT)
   - ‚úÖ –ü–æ–ª–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –º–∏–≥—Ä–∞—Ü–∏–∏ `010_add_priority_fields_phase2.sql`)
   - ‚úÖ –ï—Å—Ç—å –∏–Ω–¥–µ–∫—Å `idx_organizations_region`
   - ‚ùì **–ù–æ**: –î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤–æ –≤—Å–µ—Ö –∑–∞–ø–∏—Å—è—Ö

2. **`district`** (TEXT)
   - ‚úÖ –ü–æ–ª–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞)
   - ‚úÖ –ï—Å—Ç—å –∏–Ω–¥–µ–∫—Å `idx_organizations_district`
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–Ø—à–Ω–∞–±–∞–¥—Å–∫–∏–π", "–Æ–Ω—É—Å–∞–±–∞–¥—Å–∫–∏–π")

3. **`city`** (TEXT)
   - ‚úÖ –ü–æ–ª–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (—Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞)
   - ‚úÖ –ï—Å—Ç—å –∏–Ω–¥–µ–∫—Å `idx_organizations_city`
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–¢–∞—à–∫–µ–Ω—Ç", "–ê–Ω–¥–∏–∂–∞–Ω")

---

## ‚ùå –ß—Ç–æ –û–¢–°–£–¢–°–¢–í–£–ï–¢ –≤ –ë–î

### 1. –ù–µ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü

–í –ë–î **–Ω–µ—Ç** –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü:
- ‚ùå `regions` - —Ç–∞–±–ª–∏—Ü–∞ –æ–±–ª–∞—Å—Ç–µ–π
- ‚ùå `districts` - —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞–π–æ–Ω–æ–≤

### 2. –ù–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏

- –ó–Ω–∞—á–µ–Ω–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ **—Ç–µ–∫—Å—Ç** (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ê–Ω–¥–∏–∂–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å", "–Ø—à–Ω–∞–±–∞–¥—Å–∫–∏–π —Ä–∞–π–æ–Ω")
- –ù–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É `region` –∏ `district` —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏
- –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö (–º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –ª—é–±–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)

### 3. –ù–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º uzbekistan-regions-data

–î–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏–º–µ—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
```json
// regions.json
{"id": 11, "soato_id": 1726, "name_uz": "Toshkent shahri", ...}

// districts.json  
{"id": 16, "region_id": 2, "soato_id": 1703202, "name_uz": "Oltinko'l tumani", ...}
```

–ù–æ –≤ –ë–î:
- –ù–µ—Ç `id`, `soato_id`
- –ù–µ—Ç —Å–≤—è–∑–∏ `region_id` –º–µ–∂–¥—É —Ä–∞–π–æ–Ω–∞–º–∏ –∏ –æ–±–ª–∞—Å—Ç—è–º–∏
- –ù–µ—Ç `name_uz`, `name_oz`, `name_ru` - —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ

---

## üìä –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:

1. **`getDistrictsWithCounts()`** –≤ `src/lib/supabase/queries.ts`
   - –ü–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ä–∞–π–æ–Ω—ã –∏–∑ `organizations.district`
   - –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∫–æ–ª
   - ‚ùå –ù–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –æ–±–ª–∞—Å—Ç–∏ (region)

2. **`getCities()`**
   - –ü–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –∏–∑ `organizations.city`

3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ `getSchoolsWithFilters()`**
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ `district` —á–µ—Ä–µ–∑ `.in('district', filters.districts)`
   - ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–µ `region` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

---

## üîÑ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è (–±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ)

1. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–µ `region` –¥–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
2. –û–±–Ω–æ–≤–∏—Ç—å `getDistrictsWithCounts()` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ `region`
3. –û–±–Ω–æ–≤–∏—Ç—å `getSchoolsWithFilters()` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ `region`

**–ü–ª—é—Å—ã:**
- –ë—ã—Å—Ç—Ä–æ
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –ù–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
- –°–ª–æ–∂–Ω–µ–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)

1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã `regions` –∏ `districts`
2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è uzbekistan-regions-data
3. –î–æ–±–∞–≤–∏—Ç—å `region_id` –∏ `district_id` –≤ `organizations`
4. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

**–ü–ª—é—Å—ã:**
- –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- –ì–∞—Ä–∞–Ω—Ç–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º

**–ú–∏–Ω—É—Å—ã:**
- –ë–æ–ª—å—à–µ —Ä–∞–±–æ—Ç—ã
- –ù—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

–î–ª—è **–±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–í–∞—Ä–∏–∞–Ω—Ç 1**, –∑–∞—Ç–µ–º –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ **–í–∞—Ä–∏–∞–Ω—Ç 2**.

### –®–∞–≥–∏ –¥–ª—è –í–∞—Ä–∏–∞–Ω—Ç–∞ 1:

1. ‚úÖ –ó–∞–ø–æ–ª–Ω–∏—Ç—å `region` –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å—è—Ö (–µ—Å–ª–∏ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ)
2. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ `region`
3. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ `public/data/regions.json` –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–±–ª–∞—Å—Ç–∏
4. ‚úÖ –°–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–π–æ–Ω—ã —Å –æ–±–ª–∞—Å—Ç—è–º–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (–∏–∑ districts.json)

### –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–π–æ–Ω–æ–≤ –ø–æ –æ–±–ª–∞—Å—Ç–∏:

1. –°–∫–∞—á–∞—Ç—å `districts.json` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ä–∞–π–æ–Ω—ã –ø–æ `region_id`
3. –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–π–æ–Ω—ã –≤ `DistrictMultiSelect`

