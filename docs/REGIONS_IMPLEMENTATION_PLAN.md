# План реализации выбора областей и регионов

## Источник данных

Репозиторий: https://github.com/MIMAXUZ/uzbekistan-regions-data.git

### Структура данных

Согласно репозиторию:
- **14 регионов** (включая Ташкент и Республику Каракалпакстан)
- **210 городов областного подчинения**
- **2,641+ районов (туманов)**
- Данные доступны в форматах: JSON, SQL, CSV

### Формат данных

Нужно использовать JSON формат для простоты интеграции. Структура должна содержать:
- `id` - уникальный идентификатор
- `name` - название на русском/кириллице
- `name_uz` - название на узбекском (латиница)
- `name_ru` - название на русском
- `parent_id` - ссылка на родительскую область (для районов)

---

## Архитектура решения

### 1. Компонент выбора области в Header

**Расположение**: Правая часть Header, рядом с кнопкой "Maktab qo'shish"

**Функционал**:
- Dropdown с выбором области
- При первом визите - показывать модальное окно выбора
- Сохранение выбора в localStorage/cookie
- Отображение текущей выбранной области

### 2. Хранение данных

**Варианты**:
1. **Статический JSON файл** в `public/data/regions.json` (рекомендуется)
   - Простота
   - Нет запросов к внешним API
   - Можно обновить вручную

2. **Git Submodule** для синхронизации с репозиторием
   - Автоматическое обновление
   - Но требует дополнительной настройки

3. **CDN/API запрос** к raw GitHub файлу
   - Динамические обновления
   - Но зависимость от внешнего ресурса

**Рекомендация**: Начать с варианта 1, потом можно перейти на 3.

### 3. Фильтр регионов в каталоге

После выбора области:
- Показывать только районы выбранной области
- Опция "O'zbekiston" для показа всех регионов
- Счетчики школ для каждого района

### 4. Контекст области

Создать React Context для хранения выбранной области:
- `RegionContext` - глобальное состояние
- Provider в layout
- Hook `useRegion()` для доступа

---

## Компоненты для создания

1. **RegionSelector** - выбор области в Header
2. **RegionDialog** - модальное окно для первого выбора
3. **RegionContext** - контекст для хранения выбранной области
4. Обновить **DistrictMultiSelect** для фильтрации по области

---

## Улучшения UX

1. **Автоопределение области**:
   - По IP (через сервис geolocation)
   - По геолокации браузера (с разрешения пользователя)
   - Fallback: показать модальное окно

2. **Визуальные индикаторы**:
   - Бейдж выбранной области
   - Иконка локации
   - Подсветка активной области в списке

3. **Персонализация**:
   - Сохранение выбора между сессиями
   - Возможность изменения области в любой момент
   - Адаптация главной страницы под выбранную область

---

## Этапы реализации

### Этап 1: Подготовка данных
- [ ] Скачать JSON данные из репозитория
- [ ] Обработать и преобразовать в нужный формат
- [ ] Сохранить в `public/data/regions.json`

### Этап 2: Компоненты
- [ ] Создать RegionContext
- [ ] Создать RegionSelector компонент
- [ ] Создать RegionDialog для первого выбора
- [ ] Обновить Header с новым дизайном

### Этап 3: Интеграция
- [ ] Интегрировать выбор области в Header
- [ ] Обновить фильтр регионов для работы с выбранной областью
- [ ] Обновить запросы к БД для фильтрации по области

### Этап 4: Улучшения
- [ ] Добавить автоопределение области
- [ ] Адаптировать главную страницу
- [ ] Добавить анимации и переходы

